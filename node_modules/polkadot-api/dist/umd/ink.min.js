(function(we,me){typeof exports=="object"&&typeof module<"u"?me(exports):typeof define=="function"&&define.amd?define(["exports"],me):(we=typeof globalThis<"u"?globalThis:we||self,me(we.papiInk={}))})(this,function(we){"use strict";const me=(e,t)=>e.type==="array"&&e.len===t&&e.value.type==="primitive"&&e.value.value==="u8",ue={type:"void"},Xn=(e,t=()=>null)=>{const n=new Map,r=new Set,s=l=>d=>{let h=n.get(d);if(h)return h;if(r.has(d)){const y={id:d};return n.set(d,y),y}r.add(d);const u=l(d);return h=n.get(d),h?Object.assign(h,u):(h={id:d,...u},n.set(d,h)),r.delete(d),h};let o=!0,c=!0;const i=s(l=>{const d=t(e[l]);if(d)return d;const{def:h,path:u,params:y}=e[l];if(h.tag==="composite"){if(h.value.length===0)return ue;if(h.value.length===1){const p=i(h.value[0].type);return o&&u.at(-1)==="AccountId32"&&me(p,32)?(o=!1,{type:"AccountId32"}):c&&u.at(-1)==="AccountId20"&&me(p,20)?(c=!1,{type:"AccountId20"}):p}return f(h.value)}if(h.tag==="variant"){if(u.length===1&&u[0]==="Option"&&y.length===1&&y[0].name==="T"){const E=i(y[0].type);return E.type==="void"?{type:"primitive",value:"bool"}:{type:"option",value:E}}if(u.length===1&&u[0]==="Result"&&y.length===2&&y[0].name==="T"&&y[1].name==="E")return{type:"result",value:{ok:i(y[0].type),ko:i(y[1].type)}};if(h.value.length===0)return ue;const p={},b={};return h.value.forEach(E=>{const O=E.name;if(b[O]=E.docs,E.fields.length===0){p[O]={...ue,idx:E.index};return}if(E.fields.length===1&&!E.fields[0].name){p[O]={type:"lookupEntry",value:i(E.fields[0].type),idx:E.index};return}p[O]={...f(E.fields),idx:E.index}}),{type:"enum",value:p,innerDocs:b}}if(h.tag==="sequence")return{type:"sequence",value:i(h.value)};if(h.tag==="array"){const{len:p}=h.value,b=i(h.value.type);return!p||b.type==="void"?ue:p>1?{type:"array",value:b,len:h.value.len}:b}if(h.tag==="tuple")return h.value.length===0?ue:h.value.length>1?a(h.value.map(p=>i(p)),h.value.map(p=>e[p].docs)):i(h.value[0]);if(h.tag==="primitive")return{type:"primitive",value:h.value.tag};if(h.tag==="compact"){const p=i(h.value);return p.type==="void"?ue:{type:"compact",isBig:Number(p.value.slice(1))>32,size:p.value}}return{type:h.tag}}),f=l=>{let d=!0;const h={},u={};return l.forEach((y,p)=>{d=d&&!!y.name;const b=y.name||p,E=i(y.type);E.type!=="void"&&(h[b]=E,u[b]=y.docs)}),d?{type:"struct",value:h,innerDocs:u}:a(Object.values(h),Object.values(u))},a=(l,d)=>{if(l.every(h=>h.id===l[0].id)&&d.every(h=>!h.length)){const[h]=l;return h.type==="void"?ue:{type:"array",value:l[0],len:l.length}}return{type:"tuple",value:l,innerDocs:d}};return i},zn=e=>Xn(e);var Fn=Object.defineProperty,Yn=(e,t,n)=>t in e?Fn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ft=(e,t,n)=>(Yn(e,typeof t!="symbol"?t+"":t,n),n),Fe={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function Wn(e){const t=e.length%2,n=(e[1]==="x"?2:0)+t,r=(e.length-n)/2+t,s=new Uint8Array(r);t&&(s[0]=0|Fe[e[2]]);for(let o=0;o<r;){const c=n+o*2,i=Fe[e[c]],f=Fe[e[c+1]];s[t+o++]=i<<4|f}return s}var yt=class extends Uint8Array{constructor(e){super(e),ft(this,"i",0),ft(this,"v"),this.v=new DataView(e)}},K=e=>t=>e(t instanceof yt?t:new yt(t instanceof Uint8Array?t.buffer:typeof t=="string"?Wn(t).buffer:t)),z=e=>{const t=e.length;let n=0;for(let s=0;s<t;s++)n+=e[s].length;const r=new Uint8Array(n);for(let s=0,o=0;s<t;s++){const c=e[s];r.set(c,o),o+=c.byteLength}return r};function Te(e,t){const n=Object.keys(e),r=n.length,s={};for(let o=0;o<r;o++){const c=n[o];s[c]=t(e[c],c)}return s}var Ye=K,x=(e,t)=>{const n=[e,t];return n.enc=e,n.dec=t,n},We=(e,t)=>n=>e(t(n)),Ge=(e,t)=>n=>t(e(n)),N=([e,t],n,r)=>x(We(e,n),Ge(t,r));function Gn(e,t){return K(n=>{const r=n.v[t](n.i,!0);return n.i+=e,r})}function Jn(e,t){return n=>{const r=new Uint8Array(e);return new DataView(r.buffer)[t](0,n,!0),r}}function ne(e,t,n){return x(Jn(e,n),Gn(e,t))}var U=ne(1,"getUint8","setUint8"),ve=ne(2,"getUint16","setUint16"),re=ne(4,"getUint32","setUint32"),Se=ne(8,"getBigUint64","setBigUint64"),Qn=ne(1,"getInt8","setInt8"),Zn=ne(2,"getInt16","setInt16"),er=ne(4,"getInt32","setInt32"),tr=ne(8,"getBigInt64","setBigInt64"),pt=e=>{const t=new Uint8Array(16),n=new DataView(t.buffer);return n.setBigInt64(0,e,!0),n.setBigInt64(8,e>>64n,!0),t},gt=e=>K(t=>{const{v:n,i:r}=t,s=n.getBigUint64(r,!0),o=n[e](r+8,!0);return t.i+=16,o<<64n|s}),nr=x(pt,gt("getBigUint64")),rr=x(pt,gt("getBigInt64")),bt=e=>{const t=new Uint8Array(32),n=new DataView(t.buffer);return n.setBigInt64(0,e,!0),n.setBigInt64(8,e>>64n,!0),n.setBigInt64(16,e>>128n,!0),n.setBigInt64(24,e>>192n,!0),t},mt=e=>K(t=>{let n=t.v.getBigUint64(t.i,!0);return t.i+=8,n|=t.v.getBigUint64(t.i,!0)<<64n,t.i+=8,n|=t.v.getBigUint64(t.i,!0)<<128n,t.i+=8,n|=t.v[e](t.i,!0)<<192n,t.i+=8,n}),sr=x(bt,mt("getBigUint64")),or=x(bt,mt("getBigInt64")),cr=N(U,e=>e?1:0,Boolean),ir=[U[1],ve[1],re[1]],ar=K(e=>{const t=e[e.i],n=t&3;if(n<3)return ir[n](e)>>>2;const r=(t>>>2)+4;e.i++;let s=0n;const o=r/8|0;let c=0n;for(let f=0;f<o;f++)s=Se[1](e)<<c|s,c+=64n;let i=r%8;return i>3&&(s=BigInt(re[1](e))<<c|s,c+=32n,i-=4),i>1&&(s=BigInt(ve[1](e))<<c|s,c+=16n,i-=2),i&&(s=BigInt(U[1](e))<<c|s),s}),lr=1n<<56n,ur=1<<24,hr=256,dr=4294967295n,fr=64,yr=16384,pr=1<<30,gr=e=>{if(e<0)throw new Error(`Wrong compact input (${e})`);const t=Number(e)<<2;if(e<fr)return U[0](t);if(e<yr)return ve[0](t|1);if(e<pr)return re[0](t|2);let n=[new Uint8Array(1)],r=BigInt(e);for(;r>=lr;)n.push(Se[0](r)),r>>=64n;r>=ur&&(n.push(re[0](Number(r&dr))),r>>=32n);let s=Number(r);s>=hr&&(n.push(ve[0](s)),s>>=16),s&&n.push(U[0](s));const o=z(n);return o[0]=o.length-5<<2|3,o},R=x(gr,ar),br=new TextEncoder,mr=e=>{const t=br.encode(e);return z([R.enc(t.length),t])},vr=new TextDecoder,wr=K(e=>{let t=R.dec(e);const n=new DataView(e.buffer,e.i,t);return e.i+=t,vr.decode(n)}),B=x(mr,wr),Er=()=>{},kr=new Uint8Array(0),v=x(()=>kr,Er),vt=e=>e===void 0?t=>z([R.enc(t.length),t]):t=>t.length===e?t:t.slice(0,e),wt=e=>K(t=>{const n=e===void 0?R.dec(t):e!==1/0?e:t.byteLength-t.i,r=new Uint8Array(t.buffer.slice(t.i,t.i+n));return t.i+=n,r}),S=e=>x(vt(e),wt(e));S.enc=vt,S.dec=wt;var Et=(e,t)=>{const n=Object.keys(e),r=new Map(t?.map((o,c)=>[n[c],o])??n.map((o,c)=>[o,c])),s=o=>r.get(o);return({tag:o,value:c})=>z([U.enc(s(o)),e[o](c)])},kt=(e,t)=>{const n=Object.keys(e),r=new Map(t?.map((s,o)=>[s,n[o]])??n.map((s,o)=>[o,s]));return K(s=>{const o=U.dec(s),c=r.get(o),i=e[c];return{tag:c,value:i(s)}})},X=(e,...t)=>x(Et(Te(e,([n])=>n),...t),kt(Te(e,([,n])=>n),...t));X.enc=Et,X.dec=kt;var xt=e=>K(t=>U[1](t)>0?e(t):void 0),It=e=>t=>{const n=new Uint8Array(1);return t===void 0?n:(n[0]=1,z([n,e(t)]))},j=e=>x(It(e[0]),xt(e[1]));j.enc=It,j.dec=xt;var At=(e,t)=>K(n=>{const r=U[1](n)===0,o=(r?e:t)(n);return{success:r,value:o}}),Bt=(e,t)=>({success:n,value:r})=>z([U[0](n?0:1),(n?e:t)(r)]),De=(e,t)=>x(Bt(e[0],t[0]),At(e[1],t[1]));De.dec=At,De.enc=Bt;var _t=(...e)=>K(t=>e.map(n=>n(t))),Ot=(...e)=>t=>z(e.map((n,r)=>n(t[r]))),F=(...e)=>x(Ot(...e.map(([t])=>t)),_t(...e.map(([,t])=>t)));F.enc=Ot,F.dec=_t;var Ut=e=>{const t=Object.keys(e);return We(F.enc(...Object.values(e)),n=>t.map(r=>n[r]))},Lt=e=>{const t=Object.keys(e);return Ge(F.dec(...Object.values(e)),n=>Object.fromEntries(n.map((r,s)=>[t[s],r])))},w=e=>x(Ut(Te(e,t=>t[0])),Lt(Te(e,t=>t[1])));w.enc=Ut,w.dec=Lt;var Tt=(e,t)=>t>=0?n=>z(n.map(e)):n=>z([R.enc(n.length),z(n.map(e))]),St=(e,t)=>K(n=>{const r=t>=0?t:R.dec(n),s=new Array(r);for(let o=0;o<r;o++)s[o]=e(n);return s}),I=(e,t)=>x(Tt(e[0],t),St(e[1],t));I.enc=Tt,I.dec=St;/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function xr(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Dt(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function Je(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Ct(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function Qe(e){if(!Array.isArray(e))throw new Error("array expected")}function Ht(e,t){if(!Dt(!0,t))throw new Error(`${e}: array of strings expected`)}function Ir(e,t){if(!Dt(!1,t))throw new Error(`${e}: array of numbers expected`)}function Ar(...e){const t=o=>o,n=(o,c)=>i=>o(c(i)),r=e.map(o=>o.encode).reduceRight(n,t),s=e.map(o=>o.decode).reduce(n,t);return{encode:r,decode:s}}function Br(e){const t=typeof e=="string"?e.split(""):e,n=t.length;Ht("alphabet",t);const r=new Map(t.map((s,o)=>[s,o]));return{encode:s=>(Qe(s),s.map(o=>{if(!Number.isSafeInteger(o)||o<0||o>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${o}". Allowed: ${e}`);return t[o]})),decode:s=>(Qe(s),s.map(o=>{Je("alphabet.decode",o);const c=r.get(o);if(c===void 0)throw new Error(`Unknown letter: "${o}". Allowed: ${e}`);return c}))}}function _r(e=""){return Je("join",e),{encode:t=>(Ht("join.decode",t),t.join(e)),decode:t=>(Je("join.decode",t),t.split(e))}}function $t(e,t,n){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: invalid to=${n}, base cannot be less than 2`);if(Qe(e),!e.length)return[];let r=0;const s=[],o=Array.from(e,i=>{if(Ct(i),i<0||i>=t)throw new Error(`invalid integer: ${i}`);return i}),c=o.length;for(;;){let i=0,f=!0;for(let a=r;a<c;a++){const l=o[a],d=t*i,h=d+l;if(!Number.isSafeInteger(h)||d/t!==i||h-l!==d)throw new Error("convertRadix: carry overflow");const u=h/n;i=h%n;const y=Math.floor(u);if(o[a]=y,!Number.isSafeInteger(y)||y*n+i!==h)throw new Error("convertRadix: carry overflow");if(f)y?f=!1:r=a;else continue}if(s.push(i),f)break}for(let i=0;i<e.length-1&&e[i]===0;i++)s.push(0);return s.reverse()}function Or(e){Ct(e);const t=2**8;return{encode:n=>{if(!xr(n))throw new Error("radix.encode input should be Uint8Array");return $t(Array.from(n),t,e)},decode:n=>(Ir("radix.decode",n),Uint8Array.from($t(n,e,t)))}}const Vt=(e=>Ar(Or(58),Br(e),_r("")))("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");function he(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Ur(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ce(e,...t){if(!Ur(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Ee(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ze(e,t){Ce(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Lr(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function de(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function He(e,t){return e<<32-t|e>>>t}const C=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Mt(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const Y=C?e=>e:e=>Mt(e);function H(e){for(let t=0;t<e.length;t++)e[t]=Mt(e[t])}function Tr(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function W(e){return typeof e=="string"&&(e=Tr(e)),Ce(e),e}class Nt{clone(){return this._cloneInto()}}function Sr(e){const t=r=>e().update(W(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Dr(e){const t=(r,s)=>e(s).update(W(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Cr(e){const t=(r,s)=>e(s).update(W(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}const Hr=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);class Rt extends Nt{constructor(t,n,r={},s,o,c){if(super(),this.blockLen=t,this.outputLen=n,this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,he(t),he(n),he(s),n<0||n>s)throw new Error("outputLen bigger than keyLen");if(r.key!==void 0&&(r.key.length<1||r.key.length>s))throw new Error("key length must be undefined or 1.."+s);if(r.salt!==void 0&&r.salt.length!==o)throw new Error("salt must be undefined or "+o);if(r.personalization!==void 0&&r.personalization.length!==c)throw new Error("personalization must be undefined or "+c);this.buffer=new Uint8Array(t),this.buffer32=de(this.buffer)}update(t){Ee(this);const{blockLen:n,buffer:r,buffer32:s}=this;t=W(t);const o=t.length,c=t.byteOffset,i=t.buffer;for(let f=0;f<o;){this.pos===n&&(C||H(s),this.compress(s,0,!1),C||H(s),this.pos=0);const a=Math.min(n-this.pos,o-f),l=c+f;if(a===n&&!(l%4)&&f+a<o){const d=new Uint32Array(i,l,Math.floor((o-f)/4));C||H(d);for(let h=0;f+n<o;h+=s.length,f+=n)this.length+=n,this.compress(d,h,!1);C||H(d);continue}r.set(t.subarray(f,f+a),this.pos),this.pos+=a,this.length+=a,f+=a}return this}digestInto(t){Ee(this),Ze(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,this.buffer.subarray(n).fill(0),C||H(r),this.compress(r,0,!0),C||H(r);const s=de(t);this.get().forEach((o,c)=>s[c]=Y(o))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:s,destroyed:o,outputLen:c,pos:i}=this;return t||(t=new this.constructor({dkLen:c})),t.set(...this.get()),t.length=r,t.finished=s,t.destroyed=o,t.outputLen=c,t.buffer.set(n),t.pos=i,t}}const $e=BigInt(2**32-1),et=BigInt(32);function Ve(e,t=!1){return t?{h:Number(e&$e),l:Number(e>>et&$e)}:{h:Number(e>>et&$e)|0,l:Number(e&$e)|0}}function jt(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:o,l:c}=Ve(e[s],t);[n[s],r[s]]=[o,c]}return[n,r]}const $r=(e,t)=>BigInt(e>>>0)<<et|BigInt(t>>>0),Vr=(e,t,n)=>e>>>n,Mr=(e,t,n)=>e<<32-n|t>>>n,Nr=(e,t,n)=>e>>>n|t<<32-n,Rr=(e,t,n)=>e<<32-n|t>>>n,jr=(e,t,n)=>e<<64-n|t>>>n-32,Pr=(e,t,n)=>e>>>n-32|t<<64-n,Kr=(e,t)=>t,qr=(e,t)=>e,Pt=(e,t,n)=>e<<n|t>>>32-n,Kt=(e,t,n)=>t<<n|e>>>32-n,qt=(e,t,n)=>t<<n-32|e>>>64-n,Xt=(e,t,n)=>e<<n-32|t>>>64-n;function Xr(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const $={fromBig:Ve,split:jt,toBig:$r,shrSH:Vr,shrSL:Mr,rotrSH:Nr,rotrSL:Rr,rotrBH:jr,rotrBL:Pr,rotr32H:Kr,rotr32L:qr,rotlSH:Pt,rotlSL:Kt,rotlBH:qt,rotlBL:Xt,add:Xr,add3L:(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H:(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L:(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H:(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,add5H:(e,t,n,r,s,o)=>t+n+r+s+o+(e/2**32|0)|0,add5L:(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0)},_=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),g=new Uint32Array(32);function se(e,t,n,r,s,o){const c=s[o],i=s[o+1];let f=g[2*e],a=g[2*e+1],l=g[2*t],d=g[2*t+1],h=g[2*n],u=g[2*n+1],y=g[2*r],p=g[2*r+1],b=$.add3L(f,l,c);a=$.add3H(b,a,d,i),f=b|0,{Dh:p,Dl:y}={Dh:p^a,Dl:y^f},{Dh:p,Dl:y}={Dh:$.rotr32H(p,y),Dl:$.rotr32L(p,y)},{h:u,l:h}=$.add(u,h,p,y),{Bh:d,Bl:l}={Bh:d^u,Bl:l^h},{Bh:d,Bl:l}={Bh:$.rotrSH(d,l,24),Bl:$.rotrSL(d,l,24)},g[2*e]=f,g[2*e+1]=a,g[2*t]=l,g[2*t+1]=d,g[2*n]=h,g[2*n+1]=u,g[2*r]=y,g[2*r+1]=p}function oe(e,t,n,r,s,o){const c=s[o],i=s[o+1];let f=g[2*e],a=g[2*e+1],l=g[2*t],d=g[2*t+1],h=g[2*n],u=g[2*n+1],y=g[2*r],p=g[2*r+1],b=$.add3L(f,l,c);a=$.add3H(b,a,d,i),f=b|0,{Dh:p,Dl:y}={Dh:p^a,Dl:y^f},{Dh:p,Dl:y}={Dh:$.rotrSH(p,y,16),Dl:$.rotrSL(p,y,16)},{h:u,l:h}=$.add(u,h,p,y),{Bh:d,Bl:l}={Bh:d^u,Bl:l^h},{Bh:d,Bl:l}={Bh:$.rotrBH(d,l,63),Bl:$.rotrBL(d,l,63)},g[2*e]=f,g[2*e+1]=a,g[2*t]=l,g[2*t+1]=d,g[2*n]=h,g[2*n+1]=u,g[2*r]=y,g[2*r+1]=p}class zr extends Rt{constructor(t={}){super(128,t.dkLen===void 0?64:t.dkLen,t,64,16,16),this.v0l=_[0]|0,this.v0h=_[1]|0,this.v1l=_[2]|0,this.v1h=_[3]|0,this.v2l=_[4]|0,this.v2h=_[5]|0,this.v3l=_[6]|0,this.v3h=_[7]|0,this.v4l=_[8]|0,this.v4h=_[9]|0,this.v5l=_[10]|0,this.v5h=_[11]|0,this.v6l=_[12]|0,this.v6h=_[13]|0,this.v7l=_[14]|0,this.v7h=_[15]|0;const n=t.key?t.key.length:0;if(this.v0l^=this.outputLen|n<<8|65536|1<<24,t.salt){const r=de(W(t.salt));this.v4l^=Y(r[0]),this.v4h^=Y(r[1]),this.v5l^=Y(r[2]),this.v5h^=Y(r[3])}if(t.personalization){const r=de(W(t.personalization));this.v6l^=Y(r[0]),this.v6h^=Y(r[1]),this.v7l^=Y(r[2]),this.v7h^=Y(r[3])}if(t.key){const r=new Uint8Array(this.blockLen);r.set(W(t.key)),this.update(r)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:s,v2l:o,v2h:c,v3l:i,v3h:f,v4l:a,v4h:l,v5l:d,v5h:h,v6l:u,v6h:y,v7l:p,v7h:b}=this;return[t,n,r,s,o,c,i,f,a,l,d,h,u,y,p,b]}set(t,n,r,s,o,c,i,f,a,l,d,h,u,y,p,b){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=o|0,this.v2h=c|0,this.v3l=i|0,this.v3h=f|0,this.v4l=a|0,this.v4h=l|0,this.v5l=d|0,this.v5h=h|0,this.v6l=u|0,this.v6h=y|0,this.v7l=p|0,this.v7h=b|0}compress(t,n,r){this.get().forEach((f,a)=>g[a]=f),g.set(_,16);let{h:s,l:o}=$.fromBig(BigInt(this.length));g[24]=_[8]^o,g[25]=_[9]^s,r&&(g[28]=~g[28],g[29]=~g[29]);let c=0;const i=Hr;for(let f=0;f<12;f++)se(0,4,8,12,t,n+2*i[c++]),oe(0,4,8,12,t,n+2*i[c++]),se(1,5,9,13,t,n+2*i[c++]),oe(1,5,9,13,t,n+2*i[c++]),se(2,6,10,14,t,n+2*i[c++]),oe(2,6,10,14,t,n+2*i[c++]),se(3,7,11,15,t,n+2*i[c++]),oe(3,7,11,15,t,n+2*i[c++]),se(0,5,10,15,t,n+2*i[c++]),oe(0,5,10,15,t,n+2*i[c++]),se(1,6,11,12,t,n+2*i[c++]),oe(1,6,11,12,t,n+2*i[c++]),se(2,7,8,13,t,n+2*i[c++]),oe(2,7,8,13,t,n+2*i[c++]),se(3,4,9,14,t,n+2*i[c++]),oe(3,4,9,14,t,n+2*i[c++]);this.v0l^=g[0]^g[16],this.v0h^=g[1]^g[17],this.v1l^=g[2]^g[18],this.v1h^=g[3]^g[19],this.v2l^=g[4]^g[20],this.v2h^=g[5]^g[21],this.v3l^=g[6]^g[22],this.v3h^=g[7]^g[23],this.v4l^=g[8]^g[24],this.v4h^=g[9]^g[25],this.v5l^=g[10]^g[26],this.v5h^=g[11]^g[27],this.v6l^=g[12]^g[28],this.v6h^=g[13]^g[29],this.v7l^=g[14]^g[30],this.v7h^=g[15]^g[31],g.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Me=Dr(e=>new zr(e)),zt=new TextEncoder().encode("SS58PRE"),tt=2,Ft=e=>{try{const t=Vt.decode(e),n=t.subarray(0,t[0]&64?2:1),r=t.subarray(n.length,t.length-tt),s=t.subarray(n.length+r.length),o=Me(Uint8Array.of(...zt,...n,...r),{dkLen:64}).subarray(0,tt);return s[0]===o[0]&&s[1]===o[1]?{isValid:!0,ss58Format:Fr(n),publicKey:r.slice()}:{isValid:!1}}catch{return{isValid:!1}}},Fr=e=>{const t=new DataView(e.buffer,e.byteOffset,e.byteLength);return t.byteLength===1?t.getUint8(0):t.getUint16(0)},Yt=e=>{const t=e<64?Uint8Array.of(e):Uint8Array.of((e&252)>>2|64,e>>8|(e&3)<<6);return n=>{const r=Me(Uint8Array.of(...zt,...t,...n),{dkLen:64}).subarray(0,tt);return Vt.encode(Uint8Array.of(...t,...n,...r))}};function Yr(e,t){return n=>{const r=Ft(n);if(!r.isValid)throw new Error("Invalid checksum");const{publicKey:s}=r;if(s.length!==e)throw new Error("Invalid public key length");return s}}const nt=(e=42,t=32)=>N(S(t),Yr(t),Yt(e)),Wt="0123456789abcdef";function G(e){const t=new Array(e.length+1);t[0]="0x";for(let n=0;n<e.length;){const r=e[n++];t[n]=Wt[r>>4]+Wt[r&15]}return t.join("")}const rt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function ke(e){const t=e.length%2,n=(e[1]==="x"?2:0)+t,r=(e.length-n)/2+t,s=new Uint8Array(r);t&&(s[0]=0|rt[e[2]]);for(let o=0;o<r;){const c=n+o*2,i=rt[e[c]],f=rt[e[c+1]];s[t+o++]=i<<4|f}return s}function Gt(e,t){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,t(r,n)]))}const fe=(...e)=>{const t=e.reduce((r,s)=>r+s.byteLength,0),n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const o=e[r];n.set(o,s),s+=o.byteLength}return n};var Wr=Object.defineProperty,Jt=e=>{throw TypeError(e)},Gr=(e,t,n)=>t in e?Wr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xe=(e,t,n)=>Gr(e,typeof t!="symbol"?t+"":t,n),Qt=(e,t,n)=>t.has(e)||Jt("Cannot "+n),J=(e,t,n)=>(Qt(e,t,"read from private field"),n?n.call(e):t.get(e)),Ie=(e,t,n)=>t.has(e)?Jt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),ye=(e,t,n,r)=>(Qt(e,t,"write to private field"),t.set(e,n),n),Q,Ae,Ne,Re,je;const Jr=new TextEncoder,Qr=new TextDecoder,Zr=F(R,S(1/0))[1];class Z{constructor(t,n=!1){if(Ie(this,Q),Ie(this,Ae,null),Ie(this,Ne,null),Ie(this,Re,null),Ie(this,je,null),xe(this,"asText",()=>J(this,je)??ye(this,je,Qr.decode(J(this,Q)))),xe(this,"asHex",()=>J(this,Ne)||ye(this,Ne,G(J(this,Q)))),xe(this,"asOpaqueHex",()=>J(this,Re)||ye(this,Re,G(this.asBytes()))),xe(this,"asBytes",()=>J(this,Q)),xe(this,"asOpaqueBytes",()=>J(this,Ae)||ye(this,Ae,fe(R[0](J(this,Q).length),J(this,Q)))),n){try{const[r,s]=Zr(t);if(r===s.length){ye(this,Q,s),ye(this,Ae,t);return}}catch{}throw new Error("Invalid opaque bytes")}else ye(this,Q,t)}static fromText(t){return new this(Jr.encode(t))}static fromHex(t){return new this(ke(t))}static fromOpaqueHex(t){return new this(ke(t),!0)}static fromBytes(t){return new this(t)}static fromOpaqueBytes(t){return new this(t,!0)}}Q=new WeakMap,Ae=new WeakMap,Ne=new WeakMap,Re=new WeakMap,je=new WeakMap;const[es]=nt();class Zt extends Z{constructor(t){super(t)}static fromArray(t){return new this(new Uint8Array(t))}static fromAccountId32(t){return new this(es(t))}}const en=e=>{const t=S.enc(e);return n=>t(n.asBytes())},tn=e=>{const t=S.dec(e),n=e==null?Z:Zt;return r=>n.fromBytes(t(r))},Be=e=>x(en(e),tn(e));Be.enc=en,Be.dec=tn;const m=N(R,e=>e,Number),nn=N(R,e=>e,BigInt),ts=Ye(e=>{const t=m.dec(e),n=Math.ceil(t/8);return{bytes:S(n).dec(e),bitsLen:t}}),rn=x(e=>{if(e.bitsLen>e.bytes.length*8)throw new Error(`Not enough bytes. (bitsLen:${e.bitsLen}, bytesLen:${e.bytes.length})`);const t=m.enc(e.bitsLen),n=new Uint8Array(e.bytes.length+t.length);return n.set(t,0),n.set(e.bytes,t.length),n},ts),ns=N(U,e=>e.charCodeAt(0),String.fromCharCode),sn=e=>{const t=S.enc(e);return n=>t(ke(n))},on=e=>{const t=S.dec(e);return n=>G(t(n))},ce=e=>x(sn(e),on(e));ce.enc=sn,ce.dec=on;const rs=new TextEncoder,ss=new TextDecoder,os=e=>N(S(e),t=>rs.encode(t),t=>ss.decode(t)),cn=e=>{let t=n=>{const r=e();return t=r,r(n)};return n=>t(n)},an=e=>{let t=n=>{const r=e(),s=r;return t=r,s(n)};return n=>t(n)},ln=e=>x(cn(()=>e().enc),an(()=>e().dec)),st=Object.assign((e,t)=>({type:e,value:t}),{is(e,t){return e.type===t},as(e,t){if(t!==e.type)throw new Error(`Enum.as(enum, ${t}) used with actual type ${e.type}`);return e}}),cs=new Proxy({},{get(e,t){return n=>st(t,n)}}),un=(...e)=>{const t=X.enc(...e);return n=>t({tag:n.type,value:n.value})},hn=(...e)=>{const t=X.dec(...e);return n=>{const{tag:r,value:s}=t(n);return st(r,s)}},pe=(e,...t)=>x(un(Gt(e,([n])=>n),...t),hn(Gt(e,([,n])=>n),...t));pe.enc=un,pe.dec=hn;const dn=[],fn=[],yn=[],is=BigInt(0),_e=BigInt(1),as=BigInt(2),ls=BigInt(7),us=BigInt(256),hs=BigInt(113);for(let e=0,t=_e,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],dn.push(2*(5*r+n)),fn.push((e+1)*(e+2)/2%64);let s=is;for(let o=0;o<7;o++)t=(t<<_e^(t>>ls)*hs)%us,t&as&&(s^=_e<<(_e<<BigInt(o))-_e);yn.push(s)}const[ds,fs]=jt(yn,!0),pn=(e,t,n)=>n>32?qt(e,t,n):Pt(e,t,n),gn=(e,t,n)=>n>32?Xt(e,t,n):Kt(e,t,n);function ys(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let c=0;c<10;c++)n[c]=e[c]^e[c+10]^e[c+20]^e[c+30]^e[c+40];for(let c=0;c<10;c+=2){const i=(c+8)%10,f=(c+2)%10,a=n[f],l=n[f+1],d=pn(a,l,1)^n[i],h=gn(a,l,1)^n[i+1];for(let u=0;u<50;u+=10)e[c+u]^=d,e[c+u+1]^=h}let s=e[2],o=e[3];for(let c=0;c<24;c++){const i=fn[c],f=pn(s,o,i),a=gn(s,o,i),l=dn[c];s=e[l],o=e[l+1],e[l]=f,e[l+1]=a}for(let c=0;c<50;c+=10){for(let i=0;i<10;i++)n[i]=e[c+i];for(let i=0;i<10;i++)e[c+i]^=~n[(i+2)%10]&n[(i+4)%10]}e[0]^=ds[r],e[1]^=fs[r]}n.fill(0)}class ot extends Nt{constructor(t,n,r,s=!1,o=24){if(super(),this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,he(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=de(this.state)}keccak(){C||H(this.state32),ys(this.state32,this.rounds),C||H(this.state32),this.posOut=0,this.pos=0}update(t){Ee(this);const{blockLen:n,state:r}=this;t=W(t);const s=t.length;for(let o=0;o<s;){const c=Math.min(n-this.pos,s-o);for(let i=0;i<c;i++)r[this.pos++]^=t[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:s}=this;t[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){Ee(this,!1),Ce(t),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,o=t.length;s<o;){this.posOut>=r&&this.keccak();const c=Math.min(r-this.posOut,o-s);t.set(n.subarray(this.posOut,this.posOut+c),s),this.posOut+=c,s+=c}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return he(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Ze(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:s,rounds:o,enableXOF:c}=this;return t||(t=new ot(n,r,s,c,o)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=r,t.outputLen=s,t.enableXOF=c,t.destroyed=this.destroyed,t}}const ps=((e,t,n)=>Sr(()=>new ot(t,e,n)))(1,136,256/8),bn=e=>{const t=e.slice(2),n=G(ps(t)).slice(2),r=new Array(40);for(let s=0;s<40;s++){const o=parseInt(n[s],16),c=t[s];r[s]=o>7?c.toUpperCase():c}return`0x${r.join("")}`},gs=S(20)[1],mn=x(e=>{const t=ke(e);if(t.length!==20)throw new Error(`Invalid length found on EthAddress(${e})`);const n=G(t);if(e===n||e===n.toUpperCase())return t;if(bn(n)!==e)throw new Error(`Invalid checksum found on EthAddress(${e})`);return t},Ye(e=>bn(G(gs(e))))),vn=new TextEncoder,wn=new TextDecoder,bs=N(S(4),vn.encode.bind(vn),wn.decode.bind(wn)),ct=w({engine:bs,payload:ce()}),ms=pe({consensus:ct,seal:ct,preRuntime:ct,runtimeUpdated:v},[4,5,6,8]),it=ce(32),vs=w({parentHash:it,number:m,stateRoot:it,extrinsicRoot:it,digests:I(ms)}),ee=I(B),En=j(B),ws=X({bool:v,char:v,str:v,u8:v,u16:v,u32:v,u64:v,u128:v,u256:v,i8:v,i16:v,i32:v,i64:v,i128:v,i256:v}),kn=I(w({name:En,type:m,typeName:En,docs:ee})),Es=w({len:re,type:m}),ks=w({bitStoreType:m,bitOrderType:m}),xs=I(w({name:B,fields:kn,index:U,docs:ee})),Is=X({composite:kn,variant:xs,sequence:m,array:Es,tuple:I(m),primitive:ws,compact:m,bitSequence:ks}),As=w({name:B,type:j(m)}),Bs=I(As),_s=w({id:m,path:ee,params:Bs,def:Is,docs:ee}),Pe=I(_s),Os=X({Blake2128:v,Blake2256:v,Blake2128Concat:v,Twox128:v,Twox256:v,Twox64Concat:v,Identity:v}),Us=I(Os),Ls=w({hashers:Us,key:m,value:m}),Ts=w({name:B,modifier:U,type:X({plain:m,map:Ls}),fallback:ce(),docs:ee}),Ss=j(w({prefix:B,items:I(Ts)})),xn={name:B,storage:Ss,calls:j(m),events:j(m),constants:I(w({name:B,type:m,value:ce(),docs:ee})),errors:j(m),index:U},Ds={...xn,docs:ee},Cs=new Uint8Array,In=e=>x(()=>Cs,()=>e),Hs=w({type:m,version:U,signedExtensions:I(w({identifier:B,type:m,additionalSigned:m}))}),An=w({lookup:Pe,pallets:I(w({...xn,docs:In([])})),extrinsic:Hs,type:m,apis:In([])}),$s=w({name:B,methods:I(w({name:B,inputs:I(w({name:B,type:m})),output:m,docs:ee})),docs:ee}),Vs=w({version:U,address:m,call:m,signature:m,extra:m,signedExtensions:I(w({identifier:B,type:m,additionalSigned:m}))}),Bn=w({lookup:Pe,pallets:I(w(Ds)),extrinsic:Vs,type:m,apis:I($s),outerEnums:w({call:m,event:m,error:m}),custom:I(F(B,w({type:m,value:ce()})))}),_n=()=>{throw new Error("Unsupported metadata version!")},V=x(_n,_n),Oe=w({magicNumber:re,metadata:X({v0:V,v1:V,v2:V,v3:V,v4:V,v5:V,v6:V,v7:V,v8:V,v9:V,v10:V,v11:V,v12:V,v13:V,v14:An,v15:Bn})}),at=S(),Ms=j(at),Ns=F(R,at),Rs=e=>{try{return Oe.dec(e)}catch{}try{return Oe.dec(Ms.dec(e))}catch{}try{return Oe.dec(at.dec(e))}catch{}try{return Oe.dec(Ns.dec(e)[1])}catch{}throw null},js={dkLen:32},lt=e=>Me(e,js),Ps={dkLen:16},ut=e=>Me(e,Ps),On=e=>fe(ut(e),e),te=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);function ie(e,t,n,r,s){return e=e+t+s|0,r=He(r^e,16),n=n+r|0,t=He(t^n,12),{a:e,b:t,c:n,d:r}}function ae(e,t,n,r,s){return e=e+t+s|0,r=He(r^e,8),n=n+r|0,t=He(t^n,7),{a:e,b:t,c:n,d:r}}function Un(e,t,n,r,s,o,c,i,f,a,l,d,h,u,y,p,b,E,O,M){let A=0;for(let be=0;be<r;be++)({a:s,b:f,c:h,d:b}=ie(s,f,h,b,n[t+e[A++]])),{a:s,b:f,c:h,d:b}=ae(s,f,h,b,n[t+e[A++]]),{a:o,b:a,c:u,d:E}=ie(o,a,u,E,n[t+e[A++]]),{a:o,b:a,c:u,d:E}=ae(o,a,u,E,n[t+e[A++]]),{a:c,b:l,c:y,d:O}=ie(c,l,y,O,n[t+e[A++]]),{a:c,b:l,c:y,d:O}=ae(c,l,y,O,n[t+e[A++]]),{a:i,b:d,c:p,d:M}=ie(i,d,p,M,n[t+e[A++]]),{a:i,b:d,c:p,d:M}=ae(i,d,p,M,n[t+e[A++]]),{a:s,b:a,c:y,d:M}=ie(s,a,y,M,n[t+e[A++]]),{a:s,b:a,c:y,d:M}=ae(s,a,y,M,n[t+e[A++]]),{a:o,b:l,c:p,d:b}=ie(o,l,p,b,n[t+e[A++]]),{a:o,b:l,c:p,d:b}=ae(o,l,p,b,n[t+e[A++]]),{a:c,b:d,c:h,d:E}=ie(c,d,h,E,n[t+e[A++]]),{a:c,b:d,c:h,d:E}=ae(c,d,h,E,n[t+e[A++]]),{a:i,b:f,c:u,d:O}=ie(i,f,u,O,n[t+e[A++]]),{a:i,b:f,c:u,d:O}=ae(i,f,u,O,n[t+e[A++]]);return{v0:s,v1:o,v2:c,v3:i,v4:f,v5:a,v6:l,v7:d,v8:h,v9:u,v10:y,v11:p,v12:b,v13:E,v14:O,v15:M}}var q;(function(e){e[e.CHUNK_START=1]="CHUNK_START",e[e.CHUNK_END=2]="CHUNK_END",e[e.PARENT=4]="PARENT",e[e.ROOT=8]="ROOT",e[e.KEYED_HASH=16]="KEYED_HASH",e[e.DERIVE_KEY_CONTEXT=32]="DERIVE_KEY_CONTEXT",e[e.DERIVE_KEY_MATERIAL=64]="DERIVE_KEY_MATERIAL"})(q||(q={}));const Ln=(()=>{const e=Array.from({length:16},(r,s)=>s),t=r=>[2,6,3,10,7,0,4,13,1,11,12,5,9,14,15,8].map(s=>r[s]),n=[];for(let r=0,s=e;r<7;r++,s=t(s))n.push(...s);return Uint8Array.from(n)})();class ht extends Rt{constructor(t={},n=0){if(super(64,t.dkLen===void 0?32:t.dkLen,{},Number.MAX_SAFE_INTEGER,0,0),this.flags=0,this.chunkPos=0,this.chunksDone=0,this.stack=[],this.posOut=0,this.bufferOut32=new Uint32Array(16),this.chunkOut=0,this.enableXOF=!0,this.outputLen=t.dkLen===void 0?32:t.dkLen,he(this.outputLen),t.key!==void 0&&t.context!==void 0)throw new Error("Blake3: only key or context can be specified at same time");if(t.key!==void 0){const r=W(t.key).slice();if(r.length!==32)throw new Error("Blake3: key should be 32 byte");this.IV=de(r),C||H(this.IV),this.flags=n|q.KEYED_HASH}else if(t.context!==void 0){const r=new ht({dkLen:32},q.DERIVE_KEY_CONTEXT).update(t.context).digest();this.IV=de(r),C||H(this.IV),this.flags=n|q.DERIVE_KEY_MATERIAL}else this.IV=te.slice(),this.flags=n;this.state=this.IV.slice(),this.bufferOut=Lr(this.bufferOut32)}get(){return[]}set(){}b2Compress(t,n,r,s=0){const{state:o,pos:c}=this,{h:i,l:f}=Ve(BigInt(t),!0),{v0:a,v1:l,v2:d,v3:h,v4:u,v5:y,v6:p,v7:b,v8:E,v9:O,v10:M,v11:A,v12:be,v13:Xe,v14:ze,v15:wo}=Un(Ln,s,r,7,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],te[0],te[1],te[2],te[3],i,f,c,n);o[0]=a^E,o[1]=l^O,o[2]=d^M,o[3]=h^A,o[4]=u^be,o[5]=y^Xe,o[6]=p^ze,o[7]=b^wo}compress(t,n=0,r=!1){let s=this.flags;if(this.chunkPos||(s|=q.CHUNK_START),(this.chunkPos===15||r)&&(s|=q.CHUNK_END),r||(this.pos=this.blockLen),this.b2Compress(this.chunksDone,s,t,n),this.chunkPos+=1,this.chunkPos===16||r){let o=this.state;this.state=this.IV.slice();for(let c,i=this.chunksDone+1;(r||!(i&1))&&(c=this.stack.pop());i>>=1)this.buffer32.set(c,0),this.buffer32.set(o,8),this.pos=this.blockLen,this.b2Compress(0,this.flags|q.PARENT,this.buffer32,0),o=this.state,this.state=this.IV.slice();this.chunksDone++,this.chunkPos=0,this.stack.push(o)}this.pos=0}_cloneInto(t){t=super._cloneInto(t);const{IV:n,flags:r,state:s,chunkPos:o,posOut:c,chunkOut:i,stack:f,chunksDone:a}=this;return t.state.set(s.slice()),t.stack=f.map(l=>Uint32Array.from(l)),t.IV.set(n),t.flags=r,t.chunkPos=o,t.chunksDone=a,t.posOut=c,t.chunkOut=i,t.enableXOF=this.enableXOF,t.bufferOut32.set(this.bufferOut32),t}destroy(){this.destroyed=!0,this.state.fill(0),this.buffer32.fill(0),this.IV.fill(0),this.bufferOut32.fill(0);for(let t of this.stack)t.fill(0)}b2CompressOut(){const{state:t,pos:n,flags:r,buffer32:s,bufferOut32:o}=this,{h:c,l:i}=Ve(BigInt(this.chunkOut++));C||H(s);const{v0:f,v1:a,v2:l,v3:d,v4:h,v5:u,v6:y,v7:p,v8:b,v9:E,v10:O,v11:M,v12:A,v13:be,v14:Xe,v15:ze}=Un(Ln,0,s,7,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],te[0],te[1],te[2],te[3],i,c,n,r);o[0]=f^b,o[1]=a^E,o[2]=l^O,o[3]=d^M,o[4]=h^A,o[5]=u^be,o[6]=y^Xe,o[7]=p^ze,o[8]=t[0]^b,o[9]=t[1]^E,o[10]=t[2]^O,o[11]=t[3]^M,o[12]=t[4]^A,o[13]=t[5]^be,o[14]=t[6]^Xe,o[15]=t[7]^ze,C||(H(s),H(o)),this.posOut=0}finish(){if(this.finished)return;this.finished=!0,this.buffer.fill(0,this.pos);let t=this.flags|q.ROOT;this.stack.length?(t|=q.PARENT,C||H(this.buffer32),this.compress(this.buffer32,0,!0),C||H(this.buffer32),this.chunksDone=0,this.pos=this.blockLen):t|=(this.chunkPos?0:q.CHUNK_START)|q.CHUNK_END,this.flags=t,this.b2CompressOut()}writeInto(t){Ee(this,!1),Ce(t),this.finish();const{blockLen:n,bufferOut:r}=this;for(let s=0,o=t.length;s<o;){this.posOut>=n&&this.b2CompressOut();const c=Math.min(n-this.posOut,o-s);t.set(r.subarray(this.posOut,this.posOut+c),s),this.posOut+=c,s+=c}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible after digest call");return this.writeInto(t)}xof(t){return he(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Ze(t,this),this.finished)throw new Error("digest() was already called");return this.enableXOF=!1,this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}}const Ks=Cr(e=>new ht(e)),qs={dkLen:32},Tn=e=>Ks(e,qs),Xs=e=>fe(Tn(e),e),Sn=e=>e,ge=(e,t,n,r)=>new DataView(new Uint16Array([e,t,n,r]).buffer).getBigUint64(0,!0),dt=2n**64n-1n,D=(e,t)=>e<<t&dt|e>>64n-t,k=(e,t)=>e*t&dt,L=(e,t)=>e+t&dt,T=11400714785074694791n,P=14029467366897019727n,Dn=1609587929392839161n,Ue=9650029242287828579n,Cn=2870177450012600261n;function le(e,t=0n){let n=L(L(t,T),P),r=L(t,P),s=t,o=t-T,c=e.length,i=0,f=null;(function(){let u=0,y=u+c;if(c){if(f=new Uint8Array(32),c<32){f.set(e.subarray(0,c),i),i+=c;return}if(u<=y-32){const p=y-32;do{let b;b=ge(e[u+1]<<8|e[u],e[u+3]<<8|e[u+2],e[u+5]<<8|e[u+4],e[u+7]<<8|e[u+6]),n=k(D(L(n,k(b,P)),31n),T),u+=8,b=ge(e[u+1]<<8|e[u],e[u+3]<<8|e[u+2],e[u+5]<<8|e[u+4],e[u+7]<<8|e[u+6]),r=k(D(L(r,k(b,P)),31n),T),u+=8,b=ge(e[u+1]<<8|e[u],e[u+3]<<8|e[u+2],e[u+5]<<8|e[u+4],e[u+7]<<8|e[u+6]),s=k(D(L(s,k(b,P)),31n),T),u+=8,b=ge(e[u+1]<<8|e[u],e[u+3]<<8|e[u+2],e[u+5]<<8|e[u+4],e[u+7]<<8|e[u+6]),o=k(D(L(o,k(b,P)),31n),T),u+=8}while(u<=p)}u<y&&(f.set(e.subarray(u,y),i),i=y-u)}})(),e=f||e;let a,l=0;for(c>=32?(a=D(n,1n),a=L(a,D(r,7n)),a=L(a,D(s,12n)),a=L(a,D(o,18n)),n=k(D(k(n,P),31n),T),a=a^n,a=L(k(a,T),Ue),r=k(D(k(r,P),31n),T),a=a^r,a=L(k(a,T),Ue),s=k(D(k(s,P),31n),T),a=a^s,a=L(k(a,T),Ue),o=k(D(k(o,P),31n),T),a=a^o,a=L(k(a,T),Ue)):a=L(t,Cn),a=L(a,BigInt(c));l<=i-8;){let h=ge(e[l+1]<<8|e[l],e[l+3]<<8|e[l+2],e[l+5]<<8|e[l+4],e[l+7]<<8|e[l+6]);h=k(D(k(h,P),31n),T),a=L(k(D(a^h,27n),T),Ue),l+=8}if(l+4<=i){let h=k(ge(e[l+1]<<8|e[l],e[l+3]<<8|e[l+2],0,0),T);a=L(k(D(a^h,23n),P),Dn),l+=4}for(;l<i;){const h=k(ge(e[l++],0,0,0),Cn);a=k(D(a^h,11n),T)}let d=a>>33n;return a=k(a^d,P),d=a>>29n,a=k(a^d,Dn),d=a>>32n,a^=d,a}const Ke=e=>{const t=new Uint8Array(16),n=new DataView(t.buffer);return n.setBigUint64(0,le(e),!0),n.setBigUint64(8,le(e,1n),!0),t},Hn=e=>{const t=new Uint8Array(32),n=new DataView(t.buffer);return n.setBigUint64(0,le(e),!0),n.setBigUint64(8,le(e,1n),!0),n.setBigUint64(16,le(e,2n),!0),n.setBigUint64(24,le(e,3n),!0),t},$n=e=>fe(Se.enc(le(e)),e),Vn=new TextEncoder,zs=new Map([[Sn,0],[$n,8],[On,16],[ut,-16],[lt,-32],[Ke,-16],[Hn,-32]]),Fs=e=>{const t=Ke(Vn.encode(e));return(n,...r)=>{const s=fe(t,Ke(Vn.encode(n))),o=G(s),c=a=>{if(!a.startsWith(o))throw new Error(`key does not match this storage (${e}.${n})`);if(r.length===0)return[];const l=ke(a.slice(o.length)),d=new Array(r.length);for(let h=0,u=0;h<r.length;h++){const[y,p]=r[h],b=zs.get(p);if(b==null)throw new Error("Unknown hasher");if(b<0){const E=b*-1;d[h]=G(l.slice(u,u+E)),u+=E}else u+=b,d[h]=y.dec(l.slice(u)),u+=y.enc(d[h]).length}return d},i=r.map(([{enc:a},l])=>d=>l(a(d)));return{enc:(...a)=>G(fe(s,...a.map((l,d)=>i[d](l)))),dec:c}}},Ys=Z.fromText("modlpy/utilisuba").asBytes(),Ws=({threshold:e,signatories:t})=>{const n=Mn(t),r=fe(Ys,R.enc(n.length),...n,ve.enc(e));return lt(r)},Mn=e=>e.slice().sort((t,n)=>{for(let r=0;;r++){const s=r>=t.length,o=r>=n.length;if(s&&o)return 0;if(s)return-1;if(o)return 1;if(t[r]!==n[r])return t[r]>n[r]?1:-1}});var Gs=Object.freeze({__proto__:null,AccountId:nt,Bin:Be,Binary:Z,Blake2128:ut,Blake2128Concat:On,Blake2256:lt,Blake3256:Tn,Blake3256Concat:Xs,Bytes:S,Enum:st,FixedSizeBinary:Zt,Hex:ce,Identity:Sn,Option:j,Result:De,ScaleEnum:X,Self:ln,Storage:Fs,Struct:w,Tuple:F,Twox128:Ke,Twox256:Hn,Twox64Concat:$n,Variant:pe,Vector:I,_Enum:cs,_void:v,bitSequence:rn,blockHeader:vs,bool:cr,char:ns,compact:R,compactBn:nn,compactNumber:m,createCodec:x,createDecoder:Ye,decAnyMetadata:Rs,enhanceCodec:N,enhanceDecoder:Ge,enhanceEncoder:We,ethAccount:mn,fixedStr:os,fromBufferToBase58:Yt,getMultisigAccountId:Ws,getSs58AddressInfo:Ft,h64:le,i128:rr,i16:Zn,i256:or,i32:er,i64:tr,i8:Qn,metadata:Oe,selfDecoder:an,selfEncoder:cn,sortMultisigSignatories:Mn,str:B,u128:nr,u16:ve,u256:sr,u32:re,u64:Se,u8:U,v14:An,v14Lookup:Pe,v15:Bn});const Js=(e,t,n)=>(r,s,o,...c)=>{const{id:i}=r;if(s.has(i))return s.get(i);if(o.has(i)){const a=t(()=>s.get(i),r,...c);return s.set(i,a),a}o.add(i);let f=e(r,s,o,...c);return o.delete(i),s.has(i)&&(f=n(f,s.get(i),r,...c)),s.set(i,f),f},Qs=Be(),Nn=Js((e,t,n,r)=>{if(e.type==="primitive")return Gs[e.value];if(e.type==="void")return v;if(e.type==="AccountId32")return r;if(e.type==="AccountId20")return mn;if(e.type==="compact")return e.isBig?nn:m;if(e.type==="bitSequence")return rn;const s=u=>Nn(u,t,n,r),o=(u,y)=>{const p=s(u);return y?I(p,y):I(p)},c=u=>F(...u.map(s)),i=u=>{const y=Object.fromEntries(Object.entries(u).map(([p,b])=>[p,s(b)]));return w(y)};if(e.type==="sequence"&&e.value.type==="primitive"&&e.value.value==="u8")return Qs;if(e.type==="array")return e.value.type==="primitive"&&e.value.value==="u8"?Be(e.len):o(e.value,e.len);if(e.type==="sequence")return o(e.value);if(e.type==="tuple")return c(e.value);if(e.type==="struct")return i(e.value);if(e.type==="option")return j(s(e.value));if(e.type==="result")return De(s(e.value.ok),s(e.value.ko));const f=Object.values(e.value).map(u=>{switch(u.type){case"void":return v;case"lookupEntry":return s(u.value);case"tuple":return c(u.value);case"struct":return i(u.value);case"array":return o(u.value,u.len)}}),a=Object.fromEntries(Object.keys(e.value).map((u,y)=>[u,f[y]])),l=Object.values(e.value).map(u=>u.idx),h=l.every((u,y)=>u===y)?pe(a):pe(a,l);return e.byteLength?eo(h,e.byteLength):h},ln,e=>e),Zs=(e,t=nt())=>{const n=new Map,r=s=>Nn(e(s),n,new Set,t);return s=>r(s)},eo=(e,t)=>{const n=S(t);return x(r=>n.enc(e.enc(r)),r=>e.dec(n.dec(r)))},to=e=>{const{metadata:t}=e,n=Zs(e),r=(l="")=>{const d=e.storage[l];if(!d)throw new Error(`Storage entry ${l||"{root}"} not found`);const h=d.key==null?v:n(d.key);return{key:Rn(h,d.keyPrefix),value:n(d.typeId)}},s=l=>{const d=w(Object.fromEntries(l.args.map(h=>[h.label,n(h.type.type)])));return{call:Rn(d,l.selector),value:n(l.returnType.type)}},o=l=>{const d=t.spec.constructors.find(h=>h.label===l);if(!d)throw new Error(`Constructor ${l} not found`);return s(d)},c=l=>{const d=t.spec.messages.find(h=>h.label===l);if(!d)throw new Error(`Message ${l} not found`);return s(d)},i=l=>w(Object.fromEntries(l.args.map(d=>[d.label,n(d.type.type)])));return{buildConstructor:o,buildMessage:c,buildStorage:r,buildEvents:()=>pe(Object.fromEntries(t.spec.events.map(l=>[l.label,i(l)]))),buildEvent:l=>{const d=t.spec.events,h=(y,p)=>N(y,b=>b.value,b=>({type:p,value:b}));if(l){const y=d.find(p=>p.signature_topic===l);return y?h(i(y),y.label):null}const u=d.filter(y=>y.signature_topic===l);return u.length?no(u.map(y=>h(i(y),y.label))):null}}},Rn=(e,t)=>{const n=Z.fromHex(t).asBytes(),r=F(S(n.length),e);return N(r,s=>[n,s],([,s])=>s)},no=e=>x(t=>{for(const n of e)try{n.enc(t)}catch{}throw new Error("Unable to encode")},t=>{for(const n of e)try{n.dec(t)}catch{}throw new Error("Unable to decode")}),jn=e=>N(X(e),t=>{if(typeof t=="string")return{tag:t,value:void 0};const[n,r]=Object.entries(t)[0];return{tag:n,value:r}},t=>({[t.tag]:t.value})),Le=(e,t)=>N(I(e,t),n=>n??[],n=>n),Pn=j(B),qe=Le(B),ro=jn({bool:v,char:v,str:v,u8:v,u16:v,u32:v,u64:v,u128:v,u256:v,i8:v,i16:v,i32:v,i64:v,i128:v,i256:v}),Kn=Le(w({name:Pn,type:m,typeName:Pn,docs:qe})),so=w({len:re,type:m}),oo=w({bitStoreType:m,bitOrderType:m}),co=Le(w({name:B,fields:Kn,index:U,docs:qe})),io=jn({composite:w({fields:Kn}),variant:w({variants:co}),sequence:w({type:m}),array:so,tuple:I(m),primitive:ro,compact:m,bitSequence:oo}),ao=w({name:B,type:j(m)}),lo=Le(ao),uo=w({id:m,path:qe,params:lo,def:io,docs:qe}),ho=N(uo,e=>({id:e.id,path:e.type.path,params:e.type.params??[],def:e.type.def,docs:[]}),e=>({id:e.id,type:{def:e.def,path:e.path,params:e.params}})),fo=Le(ho),yo=e=>{const t=fo.enc(e.types),n=Pe.dec(t),r=e.spec.environment.accountId.type,s=n.find(i=>i.id===r);s&&(s.path=["AccountId32"]);const o=po(e,n),c=zn(n);return Object.assign(c,{metadata:e,lookup:n,storage:o})};function po(e,t){const n={},r=(s,o=[])=>{function c(f){const a=t.length;return t[a]={id:a,docs:[],def:f,params:[],path:[]},a}if("root"in s){const f=Number(e.version)===4?Z.fromBytes(Z.fromHex(s.root.root_key).asBytes().reverse()).asHex():s.root.root_key,a=r(s.root.layout,o);if(s.root.ty!=null){let l=function(d,h){const u=e.types[d].type,y="composite"in u.def?new Map((u.def.composite.fields??[]).map(b=>[b.name,b.type])):null,p=new Map((u.params??[]).map(b=>[b.name,b.type]));if(p.size===2&&p.has("V")&&y&&y.size===2&&y.has("len")&&y.has("elements")){l(y.get("len"),[...h,"len"]),l(y.get("elements"),h);return}else p.size===3&&p.has("K")&&p.has("V")?n[h.join(".")]={keyPrefix:f,key:p.get("K"),typeId:p.get("V")}:p.size===2&&p.has("V")&&(n[h.join(".")]={keyPrefix:f,key:null,typeId:p.get("V")})};l(s.root.ty,o)}return n[o.join(".")]||(n[o.join(".")]={keyPrefix:f,key:null,typeId:a}),c({tag:"composite",value:[]})}if("leaf"in s)return s.leaf.ty;if("hash"in s)throw new Error("HashLayout not implemented");if("array"in s){const f=r(s.array.layout,o);return f==null?null:c({tag:"array",value:{len:s.array.len,type:f}})}if("struct"in s){const f=s.struct.fields.map(a=>({name:a.name,type:r(a.layout,[...o,a.name]),typeName:void 0,docs:[]})).filter(a=>a.type!=null);return c({tag:"composite",value:f})}const i=Object.values(s.enum.variants).map((f,a)=>({name:f.name,fields:f.fields.map(l=>({name:l.name,type:r(l.layout,[...o,f.name,l.name]),typeName:void 0,docs:[]})).filter(l=>l.type!==null),index:a,docs:[]}));return c({tag:"variant",value:i})};return r(e.storage),n}const go=e=>{const t=yo(e.metadata),n=to(t);return{constructor:qn(n.buildConstructor),message:qn(n.buildMessage),storage:bo(n.buildStorage),event:Number(t.metadata.version)===4?mo(n.buildEvents):vo(t,n.buildEvent)}},qn=e=>t=>{const n=e(t);return{encode:r=>Z.fromBytes(n.call.enc(r||{})),decode:r=>n.value.dec(r.data.asBytes())}},bo=e=>t=>{const n=e(t);return{encode:r=>Z.fromBytes(n.key.enc(r)),decode:r=>n.value.dec(r.asBytes())}},mo=e=>{const t=r=>e().dec(r.data.asBytes());return{decode:t,filter:(r,s=[])=>s.map(c=>"event"in c?c.event:c).filter(c=>c.type==="Contracts"&&c.value.type==="ContractEmitted"&&c.value.value.contract===r).map(c=>{try{return t(c.value.value)}catch(i){throw console.error(`Contract ${r} emitted an incompatible event`,c.value.value),i}})}},vo=(e,t)=>{const n=new Set(e.metadata.spec.events.map(c=>c.signature_topic).filter(c=>c!=null)),r=e.metadata.spec.events.some(c=>c.signature_topic==null),s=(c,i)=>{if(i!=null){if(!n.has(i))throw new Error(`Event with signature topic ${c} not found`);return t(i).dec(c.data.asBytes())}if(!r)throw new Error("Event signature topic required");return t(void 0).dec(c.data.asBytes())};return{decode:s,filter:(c,i=[])=>i.map(a=>"event"in a?a:{event:a,topics:a.topics}).filter(a=>a.event.type==="Contracts"&&a.event.value.type==="ContractEmitted"&&a.event.value.value.contract===c).map(a=>{const l=a.topics.map(h=>h.asHex()),d=l.find(h=>n.has(h));try{return s(a.event.value.value,d)}catch{return console.error(`Contract ${c} emitted an incompatible event`,{event:a.event.value.value.data.asHex(),eventTopics:l,metadataEventTopics:[...n],hasAnonymousEvents:r}),null}}).filter(a=>a!==null)}};we.getInkClient=go});
