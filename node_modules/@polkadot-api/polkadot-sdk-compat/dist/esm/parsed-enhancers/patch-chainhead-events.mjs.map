{"version":3,"file":"patch-chainhead-events.mjs","sources":["../../../src/parsed-enhancers/patch-chainhead-events.ts"],"sourcesContent":["import type { ParsedJsonRpcEnhancer } from \"@/parsed\"\n\nexport const patchChainHeadEvents: ParsedJsonRpcEnhancer = (base) => (onMsg) =>\n  base((message) => {\n    const result = (message as any).params?.result\n    if (!(\"id\" in message) && result) {\n      const { prunedBlockHashes, finalizedBlockHash, event } = result\n      if (event === \"finalized\" && Array.isArray(prunedBlockHashes))\n        result.prunedBlockHashes = [...new Set(result.prunedBlockHashes)]\n      else if (event === \"initialized\" && finalizedBlockHash) {\n        result.finalizedBlockHashes = [result.finalizedBlockHash]\n        delete result.finalizedBlockHash\n      }\n    }\n    onMsg(message)\n  })\n"],"names":[],"mappings":"AAEO,MAAM,uBAA8C,CAAC,IAAA,KAAS,CAAC,KACpE,KAAA,IAAA,CAAK,CAAC,OAAY,KAAA;AAChB,EAAM,MAAA,MAAA,GAAU,QAAgB,MAAQ,EAAA,MAAA;AACxC,EAAI,IAAA,EAAE,IAAQ,IAAA,OAAA,CAAA,IAAY,MAAQ,EAAA;AAChC,IAAA,MAAM,EAAE,iBAAA,EAAmB,kBAAoB,EAAA,KAAA,EAAU,GAAA,MAAA;AACzD,IAAA,IAAI,KAAU,KAAA,WAAA,IAAe,KAAM,CAAA,OAAA,CAAQ,iBAAiB,CAAA;AAC1D,MAAA,MAAA,CAAO,oBAAoB,CAAC,GAAG,IAAI,GAAI,CAAA,MAAA,CAAO,iBAAiB,CAAC,CAAA;AAAA,SACzD,IAAA,KAAA,KAAU,iBAAiB,kBAAoB,EAAA;AACtD,MAAO,MAAA,CAAA,oBAAA,GAAuB,CAAC,MAAA,CAAO,kBAAkB,CAAA;AACxD,MAAA,OAAO,MAAO,CAAA,kBAAA;AAAA;AAChB;AAEF,EAAA,KAAA,CAAM,OAAO,CAAA;AACf,CAAC;;;;"}