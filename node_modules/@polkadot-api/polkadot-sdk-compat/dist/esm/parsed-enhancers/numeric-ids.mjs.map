{"version":3,"file":"numeric-ids.mjs","sources":["../../../src/parsed-enhancers/numeric-ids.ts"],"sourcesContent":["import type { ParsedJsonRpcEnhancer } from \"@/parsed\"\n\nexport const withNumericIds: ParsedJsonRpcEnhancer = (base) => (onMsg) => {\n  let nextId = 0\n  const numberToOriginal = new Map<number, string>()\n\n  const { send: originalSend, disconnect } = base((message: any) => {\n    if (numberToOriginal.has(message.id))\n      message.id = numberToOriginal.get(message.id)\n    onMsg(message)\n  })\n\n  return {\n    send: (msg: { id?: any }) => {\n      if (\"id\" in msg) {\n        const id = nextId++\n        numberToOriginal.set(id, msg.id)\n        msg.id = id\n      }\n      originalSend(msg)\n    },\n    disconnect,\n  }\n}\n"],"names":[],"mappings":"AAEO,MAAM,cAAwC,GAAA,CAAC,IAAS,KAAA,CAAC,KAAU,KAAA;AACxE,EAAA,IAAI,MAAS,GAAA,CAAA;AACb,EAAM,MAAA,gBAAA,uBAAuB,GAAoB,EAAA;AAEjD,EAAA,MAAM,EAAE,IAAM,EAAA,YAAA,EAAc,YAAe,GAAA,IAAA,CAAK,CAAC,OAAiB,KAAA;AAChE,IAAI,IAAA,gBAAA,CAAiB,GAAI,CAAA,OAAA,CAAQ,EAAE,CAAA;AACjC,MAAA,OAAA,CAAQ,EAAK,GAAA,gBAAA,CAAiB,GAAI,CAAA,OAAA,CAAQ,EAAE,CAAA;AAC9C,IAAA,KAAA,CAAM,OAAO,CAAA;AAAA,GACd,CAAA;AAED,EAAO,OAAA;AAAA,IACL,IAAA,EAAM,CAAC,GAAsB,KAAA;AAC3B,MAAA,IAAI,QAAQ,GAAK,EAAA;AACf,QAAA,MAAM,EAAK,GAAA,MAAA,EAAA;AACX,QAAiB,gBAAA,CAAA,GAAA,CAAI,EAAI,EAAA,GAAA,CAAI,EAAE,CAAA;AAC/B,QAAA,GAAA,CAAI,EAAK,GAAA,EAAA;AAAA;AAEX,MAAA,YAAA,CAAa,GAAG,CAAA;AAAA,KAClB;AAAA,IACA;AAAA,GACF;AACF;;;;"}